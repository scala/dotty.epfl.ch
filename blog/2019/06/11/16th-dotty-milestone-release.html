<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</title><link rel="shortcut icon" type="image/x-icon" href="../../../../favicon.ico"></link><script type="text/javascript" src="../../../../scripts/clipboard.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/platform-content-handler.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/main.js" defer="true"></script><link rel="stylesheet" href="../../../../styles/nord-light.css"></link><link rel="stylesheet" href="../../../../styles/scalastyle.css"></link><link rel="stylesheet" href="../../../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../../../styles/diagram.css"></link><link rel="stylesheet" href="../../../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../../../styles/search-bar.css"></link><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/diagram.js" defer="true"></script><link rel="stylesheet" href="../../../../styles/filter-bar.css"></link><script type="text/javascript" src="../../../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/data.js" defer="true"></script><script type="text/javascript" src="../../../../scripts/fast-navigation-loader.js" defer="true"></script><link rel="stylesheet" href="../../../../css/bootstrap.min.css"></link><link rel="stylesheet" href="../../../../css/dottydoc.css"></link><link rel="stylesheet" href="../../../../css/color-brewer.css"></link><script type="text/javascript" src="../../../../js/jquery.min.js" defer="true"></script><script type="text/javascript" src="../../../../js/bootstrap.min.js" defer="true"></script><script>var pathToRoot = "../../../../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><img src="../../../../project-logo/logo.svg"></img></span><span><div class="projectName">Scala 3</div></span><span><div class="projectVersion">3.0.0-M3-bin-20201207-c042be9-NIGHTLY</div></span></div><div id="paneSearch"></div><nav id="sideMenu"></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="searchBar"></div><main>
  <div id="content" pageIds="_.blog/_posts/2019-06-11-16th-dotty-milestone-release.md////PointingToDeclaration//-1382227006">
    <div class="breadcrumbs"><a href="../../../../docs/index.html">Scala 3</a>/<a href="../../../index.html">Blog</a>/<a href="16th-dotty-milestone-release.html">Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</a></div>
<html>
 <head>
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head>
 <body>
  <div id="content-wrapper"> 
   <main class="container"> 
    <header> 
     <h1>Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</h1> 
     <div class="byline"> <time class="date"> <i class="far fa-calendar-alt"></i> 2019-06-11 </time> <span class="author"> <i class="fas fa-pen-nib"></i> Aggelos Biboudis and Anatolii Kmetiuk </span> 
     </div> 
    </header> 
    <p>Hello again! Today, we are excited to announce the 16th release of Dotty. The development of Dotty continues according to our schedule but today, Tuesday June the 11th, we are electrified as it is the first day of <a href="https://scaladays.org/">Scala Days 2019</a> which marks the <em>10th</em> anniversary of Scala Days. With this release we are getting closer to the <em>envelope</em> of the new features that Dotty plans to offer.</p> 
    <p><img src="../../../../images/others/scala-days-logo.png" alt="" title="Scala Days 2019"></p> 
    <p>This release serves as a technology preview that demonstrates new language features and the compiler supporting them.</p> 
    <p>Dotty is the project name for technologies that are being considered for inclusion in Scala 3. Scala has pioneered the fusion of object-oriented and functional programming in a typed setting. Scala 3 will be a big step towards realising the full potential of these ideas. Its main objectives are to</p> 
    <ul> 
     <li>become more opinionated by promoting programming idioms we found to work well,</li> 
     <li>simplify where possible,</li> 
     <li>eliminate inconsistencies and surprising behaviours,</li> 
     <li>build on strong foundations to ensure the design hangs together well,</li> 
     <li>consolidate language constructs to improve the language’s consistency, safety, ergonomics, and performance.</li> 
    </ul> 
    <p>You can learn more about Dotty on our <a href="https://dotty.epfl.ch">website</a>.</p> <!--more--> 
    <p>This is our 16th scheduled release according to our <a href="https://dotty.epfl.ch/docs/contributing/procedures/release.html">6-week release schedule</a>.</p> 
    <h1><a href="#whats-new-in-the-0160-rc3-technology-preview" id="whats-new-in-the-0160-rc3-technology-preview" class="anchor"></a>What’s new in the 0.16.0-RC3 technology preview?</h1> 
    <h2><a href="#syntax-change-type-lambdas" id="syntax-change-type-lambdas" class="anchor"></a>Syntax Change: Type Lambdas</h2> 
    <p>We reconsider the syntax of type lambdas in an effort to provide an improved visual cue for two categories of types: types that relate to normal function types and types that operate on a higher level. The <em>fat</em> arrow <code>=&gt;</code> definitely relates to the first, while we reserve now <code>-&gt;</code> to mean <em>pure function</em> in the future. As a result, we disengage <code>=&gt;</code> from type lambdas, which are now represented by <code>=&gt;&gt;</code>. As a result a function from types to types is written as <code>[X] =&gt;&gt; F[X]</code>.</p> 
    <p>For those who are interested in the discussions, <a href="https://github.com/lampepfl/dotty/pull/6558">#6558</a> introduced the new syntax.</p> 
    <h2><a href="#syntax-change-wildcard-arguments-in-types" id="syntax-change-wildcard-arguments-in-types" class="anchor"></a>Syntax Change: Wildcard Arguments in Types</h2> 
    <p>The syntax of wildcard arguments in types has changed from <code>_</code> to <code>?</code>. Example:</p> 
    <pre><code class="language-scala">List[?]
Map[? &lt;: AnyRef, ? &gt;: Null]
</code></pre> 
    <p>Again, in an effort to fine-tune our syntax we put two features, from the world of terms and types, side-by-side and drew parallels at the syntactic level. Consequently, as <code>f(_)</code> is a shorthand for the lambda <code>x =&gt; f(x)</code> and as we plan ahead for making <code>C[_]</code> to be a shorthand for the type lambda <code>[X] =&gt;&gt; C[X]</code> in the future we pick <code>?</code> as a replacement syntax for wildcard types, since it aligns with Java's syntax.</p> 
    <p>For more information please read our documentation on <a href="https://dotty.epfl.ch/docs/reference/changed-features/wildcards.html">Wildcards</a>.</p> 
    <h2><a href="#syntax-change-contextual-abstractions" id="syntax-change-contextual-abstractions" class="anchor"></a>Syntax Change: Contextual Abstractions</h2> 
    <p>We reconsider the syntax for contextual abstractions introducing <code>delegates</code> (formerly known as <code>implied</code>). <code>delegate</code>, in the context of contextual abstraction means that we declare a <em>representative of a type</em>. We use <code>delegate</code> as a noun. Note that this change is solely syntactical/grammatical and its motivation is to give a clearer meaning to those <em>canonical</em> values of certain types (like <code>Ord[Int]</code>), that serve for synthesizing arguments to <code>given</code> clauses.</p> 
    <pre><code class="language-scala">delegate IntOrd for Ord[Int] {
  def compare(x: Int, y: Int) =
    if (x &lt; y) -1 else if (x &gt; y) +1 else 0
}
</code></pre> 
    <pre><code class="language-scala">delegate ListOrd[T] for Ord[List[T]] given (ord: Ord[T]) {
</code></pre> 
    <p>For more information, the documentation has been updated as part of the relevant PR <a href="https://github.com/lampepfl/dotty/pull/6649">#6649</a></p> 
    <h2><a href="#polymorphic-function-types" id="polymorphic-function-types" class="anchor"></a>Polymorphic function types</h2> 
    <p>We add preliminary support for <em>polymorphic function types</em>. Nowadays, when we want to write a universally quantified function over elements of lists of type <code>T</code> we write e.g., <code>List[T] =&gt; List[(T, T)]</code> where <code>T</code> is bound at an enclosing definition. With polymorphic function types (PFT hereafter) we can quantify the parametric type locally. For example:</p> 
    <pre><code class="language-scala">[T &lt;: AnyVal] =&gt; List[T] =&gt; List[(T, T)]
</code></pre> 
    <p>As you notice, this gives us the ability to impose restrictions on the type variable <code>T</code> locally. Assume, you have an identity function with <code>type id = T =&gt; T</code>. By writing it as <code>type id = [T] =&gt; T =&gt; T</code> we abstract further the concept of a <em>polymorphic function</em> and make it a <em>true</em> <em>family of functions</em>.</p> 
    <p>The code below (correctly) fails to type check because <code>T</code> needs to be bounded in the enclosing class:</p> 
    <pre><code class="language-scala">  val id: T =&gt; T = t =&gt; t
  println(s"${id(1)} , ${id(7.0d)}")
</code></pre> 
    <p>With PFTs we can now achieve what we want:</p> 
    <pre><code class="language-scala">  val id = [T] =&gt; (t: T) =&gt; t
  println(s"${id(1)} , ${id(7.0d)}")
</code></pre> 
    <p>For those who are interested in the discussions and more test cases, <a href="https://github.com/lampepfl/dotty/pull/4672/">#4672</a> introduced PFTs.</p> 
    <h2><a href="#lazy-vals-are-now-thread-safe-by-default" id="lazy-vals-are-now-thread-safe-by-default" class="anchor"></a><code>lazy val</code>s are now thread-safe by default</h2> 
    <p>Previously thread-safety was required using <code>@volatile</code> but that would not be consistent with Scala 2. The old behavior of non-volatile lazy vals can be recovered by using the newly-introduced <code>@threadUnsafe</code>.</p> 
    <p>For more information please read our documentation on the <a href="https://dotty.epfl.ch/docs/reference/other-new-features/threadUnsafe-annotation.html">threadUnsafe annotation</a>.</p> 
    <h2><a href="#add-support-for-java-compatible-enums" id="add-support-for-java-compatible-enums" class="anchor"></a>Add support for Java-compatible enums</h2> 
    <p>We add support for Java-compatible enumerations. The users can just extend <code>java.lang.Enum[T]</code>.</p> 
    <pre><code class="language-scala">enum A extends java.lang.Enum[A] {
  case MONDAY, TUESDAY, SATURDAY
}

enum B(val gravity: Double) extends java.lang.Enum[B] {
  case EARTH extends B(9.8)
  case JUPITER extends B(100)
  case MOON extends B(4.3)
  case Foo extends B(10)
}
</code></pre> 
    <p>For more information please check the <a href="https://github.com/lampepfl/dotty/tree/master/tests/run/enum-java">test case</a> and also the relevant PRs <a href="https://github.com/lampepfl/dotty/pull/6602">#6602</a> and <a href="https://github.com/lampepfl/dotty/pull/6629">#6629</a>.</p> 
    <p>In the test, the enums are defined in the <code>MainScala.scala</code> file and used from a Java source, <code>Test.java</code>.</p> 
    <h2><a href="#introducing-for-clauses-for-importing-delegate-imports-by-type" id="introducing-for-clauses-for-importing-delegate-imports-by-type" class="anchor"></a>Introducing <code>for</code> clauses for importing delegate imports by type</h2> 
    <p>Since delegate instances can be anonymous it is not always practical to import them by their name, and wildcard imports are typically used instead. By-type imports provide a more specific alternative to wildcard imports, which makes it clearer what is imported. Example:</p> 
    <pre><code class="language-scala">import delegate A.{for TC}
</code></pre> 
    <p>This imports any delegate instance in <code>A</code> that has a type which conforms tp <code>TC</code>. There can be several bounding types following a <code>for</code> and bounding types can contain wildcards. For instance, assuming the object</p> 
    <pre><code class="language-scala">object Delegates {
  delegate intOrd for Ordering[Int]
  delegate [T: Ordering] listOrd for Ordering[List[T]]
  delegate ec for ExecutionContext = ...
  delegate im for Monoid[Int]
}
</code></pre> 
    <p>the import</p> 
    <pre><code class="language-scala">import delegate Delegates.{for Ordering[_], ExecutionContext}
</code></pre> 
    <p>would import the <code>intOrd</code>, <code>listOrd</code>, and <code>ec</code> instances but leave out the <code>im</code> instance, since it fits none of the specified bounds.</p> 
    <h2><a href="#new-type-class-derivation-scheme" id="new-type-class-derivation-scheme" class="anchor"></a>New type class derivation scheme</h2> 
    <p>Summary of measured differences with the old scheme:</p> 
    <ul> 
     <li>About 100 lines more compiler code - the rest of the lines changed diff is tests.</li> 
     <li>About 13-15% more code generated for type class instances</li> 
     <li>About 3-4% slower to compile type class instances</li> 
    </ul> 
    <p>Advantages of new scheme:</p> 
    <ul> 
     <li>Fewer allocations, since mirrors (<code>Generic</code> has been renamed to <code>Mirror</code>) are usually shared instead of being allocated at runtime.</li> 
     <li>It works well even if there are no derives clauses. The old scheme would generate more code in that case.</li> 
     <li>Complete decoupling between derives clauses and mirror generation.</li> 
    </ul> 
    <p>For the technical details of these changes please consule the corresponding PR <a href="https://github.com/lampepfl/dotty/pull/6531">#6531</a>.</p> 
    <h1><a href="#let-us-know-what-you-think" id="let-us-know-what-you-think" class="anchor"></a>Let us know what you think!</h1> 
    <p>If you have questions or any sort of feedback, feel free to send us a message on our <a href="https://gitter.im/lampepfl/dotty">Gitter channel</a>. If you encounter a bug, please <a href="https://github.com/lampepfl/dotty/issues/new">open an issue on GitHub</a>.</p> 
    <h2><a href="#contributing" id="contributing" class="anchor"></a>Contributing</h2> 
    <p>Thank you to all the contributors who made this release possible!</p> 
    <p>According to <code>git shortlog -sn --no-merges 0.15.0-RC1..0.16.0-RC3</code> these are:</p> 
    <pre><code>88  Martin Odersky
51  Anatolii
48  Nicolas Stucki
26  Guillaume Martres
21  Miles Sabin
19  Liu Fengyun
12  Aleksander Boruch-Gruszecki
11  Sébastien Doeraene
 8  Aggelos Biboudis
 4  Olivier Blanvillain
 3  Eugene Yokota
 1  Dale Wijnand
 1  Allan Renucci
 1  Olivier ROLAND
</code></pre> 
    <p>If you want to get your hands dirty and contribute to Dotty, now is a good time to get involved! Head to our <a href="https://dotty.epfl.ch/docs/contributing/getting-started.html">Getting Started page for new contributors</a>, and have a look at some of the <a href="https://github.com/lampepfl/dotty/issues?q=is%3Aissue+is%3Aopen+label%3Aexp%3Anovice">good first issues</a>. They make perfect entry points into hacking on the compiler.</p> 
    <p>We are looking forward to having you join the team of contributors.</p> 
    <h2><a href="#library-authors-join-our-community-build" id="library-authors-join-our-community-build" class="anchor"></a>Library authors: Join our community build</h2> 
    <p>Dotty now has a set of widely-used community libraries that are built against every nightly Dotty snapshot. Currently this includes ScalaPB, algebra, scalatest, scopt and squants. Join our <a href="https://github.com/lampepfl/dotty-community-build">community build</a> to make sure that our regression suite includes your library.</p> 
   </main> 
  </div> 
  <script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'lampepfl/dotty'
  };
</script> 
  <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
 </body>
</html>  </div>
</main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span>Generated by&nbsp;<a href="https://github.com/lampepfl/dotty/tree/master/scala3doc"><img src="../../../../images/scala3doc_logo.svg" alt="Scala3doc" class="scala3doc_logo"></img></a></footer></div></div><script type="text/javascript" src="../../../../scripts/pages.js"></script><script type="text/javascript" src="../../../../scripts/main.js"></script></body></html>
