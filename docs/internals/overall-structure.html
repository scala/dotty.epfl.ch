<!DOCTYPE html><html data-githubContributorsUrl="https://api.github.com/repos/lampepfl/dotty" data-githubContributorsFilename="/docs/_docs/internals/overall-structure.md" data-pathToRoot="../../"><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"></meta><title>Dotty Overall Structure</title><link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"></link><script type="text/javascript" src="../../scripts/theme.js"></script><script type="text/javascript" src="../../scripts/searchData.js" defer="true"></script><script type="text/javascript" src="../../scripts/scastieConfiguration.js" defer="true"></script><link rel="stylesheet" href="../../styles/theme/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/components/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/components/button/bundle.css"></link><link rel="stylesheet" href="../../styles/theme/layout/bundle.css"></link><link rel="stylesheet" href="../../styles/nord-light.css"></link><link rel="stylesheet" href="../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../styles/code-snippets.css"></link><link rel="stylesheet" href="../../styles/searchbar.css"></link><link rel="stylesheet" href="../../styles/social-links.css"></link><link rel="stylesheet" href="../../styles/versions-dropdown.css"></link><link rel="stylesheet" href="../../styles/content-contributors.css"></link><link rel="stylesheet" href="../../styles/fontawesome.css"></link><script type="text/javascript" src="../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../scripts/scaladoc-scalajs.js" defer="true"></script><script type="text/javascript" src="../../scripts/contributors.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="https://scastie.scala-lang.org/embedded.js" defer="true"></script><script type="text/javascript" src="../../scripts/data.js" defer="true"></script><link rel="stylesheet" href="../../styles/staticsitestyles.css"></link><script>var pathToRoot = "../../";</script><script>var versionsDictionaryUrl = "https://scala-lang.org/api/versions.json";</script><link rel="dns-prefetch" href="//fonts.googleapis.com"> 
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
<link rel="stylesheet" href="/css/dottydoc.css"></head><body><div id=""><div id="header" class="body-small"><div class="header-container-left"><a href="../../" class="logo-container"><span id="project-logo" class="project-logo"><img src="../../project-logo/logo.svg"></img></span><span id="dark-project-logo" class="project-logo"><img src="../../project-logo/logo_dark.svg"></img></span><span class="project-name h300">Scala 3</span></a><span onclick="dropdownHandler(event)" class="text-button with-arrow" id="dropdown-trigger"><a><div class="projectVersion">3.3.1-RC1-bin-20230529-4e4552e-NIGHTLY</div></a></span><div id="version-dropdown" class="dropdown-menu"></div></div><div class="header-container-right"><button id="search-toggle" class="icon-button"></button><a href="https://docs.scala-lang.org/" class="text-button">Learn</a><a href="https://www.scala-lang.org/download/" class="text-button">Install</a><a href="https://scastie.scala-lang.org" class="text-button">Playground</a><a href="https://index.scala-lang.org" class="text-button">Find A Library</a><a href="https://www.scala-lang.org/community/" class="text-button">Community</a><a href="https://www.scala-lang.org/blog/" class="text-button">Blog</a><span id="theme-toggle" class="icon-button"></span><span id="mobile-menu-toggle" class="icon-button hamburger"></span></div></div><div id="mobile-menu"><div class="mobile-menu-header body-small"><span class="mobile-menu-logo"><span id="project-logo" class="project-logo"><img src="../../project-logo/logo.svg"></img></span><span id="dark-project-logo" class="project-logo"><img src="../../project-logo/logo_dark.svg"></img></span><span class="project-name h300">Scala 3</span></span><button id="mobile-menu-close" class="icon-button close"></button></div><div class="mobile-menu-container body-medium"><input id="mobile-scaladoc-searchbar-input" class="scaladoc-searchbar-input" type="search" placeholder="Find anything"></input><a href="https://docs.scala-lang.org/" class="mobile-menu-item">Learn</a><a href="https://www.scala-lang.org/download/" class="mobile-menu-item">Install</a><a href="https://scastie.scala-lang.org" class="mobile-menu-item">Playground</a><a href="https://index.scala-lang.org" class="mobile-menu-item">Find A Library</a><a href="https://www.scala-lang.org/community/" class="mobile-menu-item">Community</a><a href="https://www.scala-lang.org/blog/" class="mobile-menu-item">Blog</a><span id="mobile-theme-toggle" class="mobile-menu-item mode"></span></div></div><span id="mobile-sidebar-toggle" class="floating-button"></span><div id="leftColumn" class="body-small"><div class="switcher-container"><a id="docs-nav-button" class="switcher h100 selected" href="../../index.html">Docs</a><a id="api-nav-button" class="switcher h100 " href="../../api/index.html">API</a></div><nav id="docs-nav" class="side-menu"><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/index.html"><span>Reference</span></a></span><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/new-types/index.html"><span>New Types</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/intersection-types.html"><span>Intersection Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/union-types.html"><span>Union Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/type-lambdas.html"><span>Type Lambdas</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/match-types.html"><span>Match Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/dependent-function-types.html"><span>Dependent Function Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/new-types/polymorphic-function-types.html"><span>Polymorphic Function Types</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/enums/index.html"><span>Enums</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/enums/enums.html"><span>Enumerations</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/enums/adts.html"><span>Algebraic Data Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/enums/desugarEnums.html"><span>Translation of Enums and ADTs</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/contextual/index.html"><span>Contextual Abstractions</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/givens.html"><span>Given Instances</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/using-clauses.html"><span>Using Clauses</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/context-bounds.html"><span>Context Bounds</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/given-imports.html"><span>Importing Givens</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/extension-methods.html"><span>Extension Methods</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/right-associative-extension-methods.html"><span>Right-Associative Extension Methods: Details</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/type-classes.html"><span>Implementing Type classes</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/derivation.html"><span>Type Class Derivation</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/derivation-macro.html"><span>How to write a type class `derived` method using macros</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/multiversal-equality.html"><span>Multiversal Equality</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/context-functions.html"><span>Context Functions</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/conversions.html"><span>Implicit Conversions</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/by-name-context-parameters.html"><span>By-Name Context Parameters</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/contextual/relationship-implicits.html"><span>Relationship with Scala 2 Implicits</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/metaprogramming/index.html"><span>Metaprogramming</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/inline.html"><span>Inline</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/compiletime-ops.html"><span>Compile-time operations</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/macros.html"><span>Macros</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/simple-smp.html"><span>The Meta-theory of Symmetric Metaprogramming</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/staging.html"><span>Run-Time Multi-Stage Programming</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/reflection.html"><span>Reflection</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/metaprogramming/tasty-inspect.html"><span>TASTy Inspection</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/other-new-features/index.html"><span>Other New Features</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/trait-parameters.html"><span>Trait Parameters</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/transparent-traits.html"><span>Transparent Traits and Classes</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/creator-applications.html"><span>Universal Apply Methods</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/export.html"><span>Export Clauses</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/opaques.html"><span>Opaque Type Aliases</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/opaques-details.html"><span>Opaque Type Aliases: More Details</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/open-classes.html"><span>Open Classes</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/parameter-untupling.html"><span>Parameter Untupling</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/kind-polymorphism.html"><span>Kind Polymorphism</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/matchable.html"><span>The Matchable Trait</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/threadUnsafe-annotation.html"><span>The @threadUnsafe annotation</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/targetName.html"><span>The @targetName annotation</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/control-syntax.html"><span>New Control Syntax</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/indentation.html"><span>Optional Braces</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/safe-initialization.html"><span>Safe Initialization</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/type-test.html"><span>TypeTest</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/other-new-features/experimental-defs.html"><span>Experimental Definitions</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/changed-features/index.html"><span>Other Changed Features</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/numeric-literals.html"><span>Numeric Literals</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/structural-types.html"><span>Programmatic Structural Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/operators.html"><span>Rules for Operators</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/wildcards.html"><span>Wildcard Arguments in Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/imports.html"><span>Imports</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/type-inference.html"><span>Changes in Type Inference</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/implicit-resolution.html"><span>Changes in Implicit Resolution</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/implicit-conversions.html"><span>Implicit Conversions</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/overload-resolution.html"><span>Changes in Overload Resolution</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/match-syntax.html"><span>Match Expressions</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/vararg-splices.html"><span>Vararg Splices</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/pattern-bindings.html"><span>Pattern Bindings</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/pattern-matching.html"><span>Option-less pattern matching</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/eta-expansion.html"><span>Automatic Eta Expansion</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/compiler-plugins.html"><span>Changes in Compiler Plugins</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/lazy-vals-init.html"><span>Lazy Vals Initialization</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/main-functions.html"><span>Main Methods</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/changed-features/interpolation-escapes.html"><span>Escapes in interpolations</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/dropped-features/index.html"><span>Dropped Features</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/delayed-init.html"><span>Dropped: DelayedInit</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/macros.html"><span>Dropped: Scala 2 Macros</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/existential-types.html"><span>Dropped: Existential Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/type-projection.html"><span>Dropped: General Type Projection</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/do-while.html"><span>Dropped: Do-While</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/procedure-syntax.html"><span>Dropped: Procedure Syntax</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/package-objects.html"><span>Dropped: Package Objects</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/early-initializers.html"><span>Dropped: Early Initializers</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/class-shadowing.html"><span>Dropped: Class Shadowing</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/limit22.html"><span>Dropped: Limit 22</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/xml.html"><span>Dropped: XML Literals</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/symlits.html"><span>Dropped: Symbol Literals</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/auto-apply.html"><span>Dropped: Auto-Application</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/weak-conformance.html"><span>Dropped: Weak Conformance</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/nonlocal-returns.html"><span>Deprecated: Nonlocal Returns</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/this-qualifier.html"><span>Dropped: private[this] and protected[this]</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/dropped-features/wildcard-init.html"><span>Dropped: Wildcard Initializer</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/experimental/index.html"><span>Experimental</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/canthrow.html"><span>CanThrow Capabilities</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/erased-defs.html"><span>Erased Definitions</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/named-typeargs.html"><span>Named Type Arguments</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/numeric-literals.html"><span>Numeric Literals</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/explicit-nulls.html"><span>Explicit Nulls</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/main-annotation.html"><span>MainAnnotation</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/into-modifier.html"><span>The `into` Type Modifier</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/cc.html"><span>Capture Checking</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/purefuns.html"><span>Pure Function Syntax</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/experimental/tupled-function.html"><span>Tupled Function</span></a></span></div></div><div class="ni n1 "><span class="nh de"><a href="../reference/syntax.html"><span>Scala 3 Syntax Summary</span></a></span></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../reference/language-versions/index.html"><span>Language Versions</span></a></span><div class="ni n2 "><span class="nh de"><a href="../reference/language-versions/source-compatibility.html"><span>Source Compatibility</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../reference/language-versions/binary-compatibility.html"><span>Binary Compatibility</span></a></span></div></div><div class="ni n1 "><span class="nh de"><a href="../reference/soft-modifier.html"><span>Soft Keywords</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../reference/features-classification.html"><span>A Classification of Proposed Language Features</span></a></span></div></div><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../contributing/index.html"><span>Contributing</span></a></span><div class="ni n1 "><span class="nh de"><a href="../contributing/getting-started.html"><span>Getting Started</span></a></span></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../contributing/workflow/index.html"><span>Workflow</span></a></span><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/reproduce.html"><span>Reproducing an Issue</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/cause.html"><span>Finding the Cause of an Issue</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/areas.html"><span>Common Issue Locations</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/debugging.html"><span>Debugging the Compiler</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/other-debugging.html"><span>Other Debugging Techniques</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/inspection.html"><span>How to Inspect Values</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/efficiency.html"><span>Improving Your Workflow</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/testing.html"><span>Testing Your Changes</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/workflow/checklist.html"><span>Pull Request Checklist</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../contributing/tools/index.html"><span>IDEs and Tools</span></a></span><div class="ni n2 "><span class="nh de"><a href="../contributing/tools/ide.html"><span>Using an IDE</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/tools/mill.html"><span>Basic Operations with Mill</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/tools/scalafix.html"><span>Working with Scalafix</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../contributing/procedures/index.html"><span>Procedures</span></a></span><div class="ni n2 "><span class="nh de"><a href="../contributing/procedures/release.html"><span>Release Procedure</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/procedures/vulpix.html"><span>Test Vulpix Framework</span></a></span></div></div><div class="ni n1"><span class="nh de"><button class="ar icon-button "></button><a href="../contributing/architecture/index.html"><span>High Level Architecture</span></a></span><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/lifecycle.html"><span>Compiler Overview</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/context.html"><span>Contexts</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/phases.html"><span>Compiler Phases</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/types.html"><span>Compiler Types</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/time.html"><span>Time in the Compiler</span></a></span></div><div class="ni n2 "><span class="nh de"><a href="../contributing/architecture/symbols.html"><span>Symbols</span></a></span></div></div></div><div class="ni n0 expanded"><span class="nh h100 expanded cs de"><button class="ar icon-button expanded"></button><a href="index.html"><span>Internals</span></a></span><div class="ni n1 "><span class="nh de"><a href="backend.html"><span>Backend Internals</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="classpaths.html"><span>Classpaths</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="contexts.html"><span>Contexts</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="dotc-scalac.html"><span>Differences between Scalac and Dotty</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="higher-kinded-v2.html"><span>Higher-Kinded Types in Dotty</span></a></span></div><div class="ni n1 expanded"><span class="nh h100 selected de"><a href="#"><span>Dotty Overall Structure</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="explicit-nulls.html"><span>Explicit Nulls</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="periods.html"><span>Dotc&apos;s concept of time</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="syntax.html"><span>Scala 3 Syntax Summary</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="type-system.html"><span>Type System</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="dotty-internals-1-notes.html"><span>Dotty Internals 1: Trees &amp; Symbols (Meeting Notes)</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="debug-macros.html"><span>Debug Macros</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="gadts.html"><span>GADTs - Broad overview</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="coverage.html"><span>Code Coverage for Scala 3</span></a></span></div></div><div class="ni n0"><span class="nh de"><button class="ar icon-button "></button><a href="../../blog/index.html"><span>Blog (archive)</span></a></span><div class="ni n1 "><span class="nh de"><a href="../../blog/2021/06/25/scala301-rc2.html"><span>Scala 3.0.1-RC2 – backports of critical bugfixes</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2021/06/07/scala3.0.1-rc1-release.html"><span>Scala 3.0.1-RC1 – further stabilising the compiler</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2021/04/21/scala3-rc3.html"><span>Scala 3.0.0-RC3 – bug fixes for 3.0.0 stable</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2021/03/31/scala3-rc2.html"><span>Scala 3.0.0-RC2 – getting ready for 3.0.0</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2021/02/17/scala3-rc1.html"><span>Scala 3.0.0-RC1 – first release candidate is here</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/12/18/scala3-m3.html"><span>Scala 3.0.0-M3: developer&apos;s preview before RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/11/09/scala3-m1.html"><span>Scala 3.0.0-M1 is here</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/09/21/naming-schema-change.html"><span>Dotty becomes Scala 3</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/08/31/27th-dotty-milestone-release.html"><span>Announcing Dotty 0.27.0-RC1 - ScalaJS, performance, stability</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/07/27/26th-dotty-milestone-release.html"><span>Announcing Dotty 0.26.0-RC1 - unified extension methods and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/06/22/25th-dotty-milestone-release.html"><span>Announcing Dotty 0.25.0-RC2 - speed-up of givens and change in the tuple API</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/04/29/24th-dotty-milestone-release.html"><span>Announcing Dotty 0.24.0-RC1 - 2.13.2 standard library, better error messages and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/03/18/23rd-dotty-milestone-release.html"><span>Announcing Dotty 0.23.0-RC1 - safe initialization checks, type-level bitwise operations and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2020/02/05/22nd-dotty-milestone-release.html"><span>Announcing Dotty 0.22.0-RC1 - syntactic enhancements, type-level arithmetic and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/12/20/21th-dotty-milestone-release.html"><span>Announcing Dotty 0.21.0-RC1 - explicit nulls, new syntax for `match` and conditional givens, and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/11/04/20th-dotty-milestone-release.html"><span>Announcing Dotty 0.20.0-RC1 – `with` starting indentation blocks, inline given specializations and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/09/23/19th-dotty-milestone-release.html"><span>Announcing Dotty 0.19.0-RC1 – further refinements of the syntax and the migration to 2.13.1 standard library</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/08/30/18th-dotty-milestone-release.html"><span>Announcing Dotty 0.18.1-RC1 – switch to the 2.13 standard library, indentation-based syntax and other experiments</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/07/25/17th-dotty-milestone-release.html"><span>Announcing Dotty 0.17.0-RC1 – new implicit scoping rules and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/06/11/16th-dotty-milestone-release.html"><span>Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/05/23/15th-dotty-milestone-release.html"><span>Announcing Dotty 0.15.0-RC1 – the fully bootstrapped compiler</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/04/15/14th-dotty-milestone-release.html"><span>Announcing Dotty 0.14.0-RC1 with export, immutable arrays, creator applications and more</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/03/05/13th-dotty-milestone-release.html"><span>Announcing Dotty 0.13.0-RC1 with Spark support, top level definitions and redesigned implicits</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2019/01/21/12th-dotty-milestone-release.html"><span>Announcing Dotty 0.12.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2018/11/30/11th-dotty-milestone-release.html"><span>Announcing Dotty 0.11.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2018/10/10/10th-dotty-milestone-release.html"><span>Announcing Dotty 0.10.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2018/07/06/ninth-dotty-milestone-release.html"><span>Announcing Dotty 0.9.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2018/04/27/eighth-dotty-milestone-release.html"><span>Announcing Dotty 0.7.0 and 0.8.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2018/03/05/seventh-dotty-milestone-release.html"><span>Announcing Dotty 0.6.0 and 0.7.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2017/12/01/fifth-dotty-milestone-release.html"><span>Announcing Dotty 0.5.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2017/10/16/fourth-dotty-milestone-release.html"><span>Announcing Dotty 0.4.0-RC1</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2017/09/07/third-dotty-milestone-release.html"><span>Announcing Dotty 0.3.0-RC2</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2017/07/12/second-dotty-milestone-release.html"><span>Announcing Dotty 0.2.0-RC1, with new optimizations, improved stability and IDE support</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2017/05/31/first-dotty-milestone-release.html"><span>Announcing Dotty 0.1.2-RC1, a major step towards Scala 3</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2016/12/05/implicit-function-types.html"><span>Implicit Function Types</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2016/05/05/multiversal-equality.html"><span>Multiversal Equality for Scala</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2016/02/17/scaling-dot-soundness.html"><span>Scaling DOT to Scala - Soundness</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2016/02/03/essence-of-scala.html"><span>The Essence of Scala</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2016/01/02/new-year-resolutions.html"><span>New Year Resolutions</span></a></span></div><div class="ni n1 "><span class="nh de"><a href="../../blog/2015/10/23/dotty-compiler-bootstraps.html"><span>We got liftoff!</span></a></span></div></div></nav></div><div id="footer" class="body-small"><div class="left-container">Generated with</div><div class="right-container"><a href="https://github.com/lampepfl/dotty"><button class="icon-button gh"></button></a><a href="https://discord.com/invite/scala"><button class="icon-button discord"></button></a><a href="https://twitter.com/scala_lang"><button class="icon-button twitter"></button></a><div class="text">Copyright (c) 2002-2023, LAMP/EPFL</div></div><div class="text-mobile">Copyright (c) 2002-2023, LAMP/EPFL</div></div><div id="scaladoc-searchBar"></div><div id="main"><div class="breadcrumbs container"><a href="../../index.html">Scala 3</a>/<a href="index.html">Internals</a>/<a href="overall-structure.html">Dotty Overall Structure</a></div><div id="content" class="body-medium"><div><div id="content-wrapper"> 
 <div class="site-container"> 
  <div id="site-header"></div> 
  <main> 
   <header> <a class="text-button with-link body-small" href="https://github.com/lampepfl/dotty/edit/main/docs/_docs/internals/overall-structure.md">Edit this page on GitHub</a> 
    <h1 class="h600">Dotty Overall Structure</h1> 
   </header> 
   <p class="body-large first-p">The compiler code is found in package <a href="https://github.com/lampepfl/dotty/tree/main/compiler/src/dotty/tools">dotty.tools</a>. It spans the following three sub-packages:</p> 
   <div class="snippet mono-small-block"> 
    <pre><code class="language-"><span line-number="1" class=""><span class="tooltip-container"></span>backend     Compiler backends (currently for JVM and JS)
</span><span line-number="2" class=""><span class="tooltip-container"></span>   dotc     The main compiler
</span><span line-number="3" class=""><span class="tooltip-container"></span>     io     Helper modules for file access and classpath handling.
</span></code></pre> 
    <div class="buttons"></div> 
   </div> 
   <p>The <a href="https://github.com/lampepfl/dotty/tree/main/compiler/src/dotty/tools/dotc">dotc</a> package contains some main classes that can be run as separate programs. The most important one is class <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/Main.scala">Main</a>. <code>Main</code> inherits from <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/Driver.scala">Driver</a> which contains the highest level functions for starting a compiler and processing some sources. <code>Driver</code> in turn is based on two other high-level classes, <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/Compiler.scala">Compiler</a> and <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/Run.scala">Run</a>.</p> 
   <section id="package-structure-1"> 
    <h2 class="h500"><a href="#package-structure-1" class="anchor"></a>Package Structure</h2> 
    <p>Most functionality of <code>scalac</code> is implemented in subpackages of <code>dotc</code>. Here's a list of sub-packages and their focus.</p> 
    <div class="snippet mono-small-block"> 
     <pre><code class="language-"><span line-number="1" class=""><span class="tooltip-container"></span>.
</span><span line-number="2" class=""><span class="tooltip-container"></span>├── ast                 // Abstract syntax trees
</span><span line-number="3" class=""><span class="tooltip-container"></span>├── config              // Compiler configuration, settings, platform specific definitions.
</span><span line-number="4" class=""><span class="tooltip-container"></span>├── core                // Core data structures and operations, with specific subpackages for:
</span><span line-number="5" class=""><span class="tooltip-container"></span>│&nbsp;&nbsp; ├── classfile       // Reading of Java classfiles into core data structures
</span><span line-number="6" class=""><span class="tooltip-container"></span>│&nbsp;&nbsp; ├── tasty           // Reading and writing of TASTY files to/from core data structures
</span><span line-number="7" class=""><span class="tooltip-container"></span>│&nbsp;&nbsp; └── unpickleScala2  // Reading of Scala2 symbol information into core data structures
</span><span line-number="8" class=""><span class="tooltip-container"></span>├── parsing             // Scanner and parser
</span><span line-number="9" class=""><span class="tooltip-container"></span>├── printing            // Pretty-printing trees, types and other data
</span><span line-number="10" class=""><span class="tooltip-container"></span>├── repl                // The interactive REPL
</span><span line-number="11" class=""><span class="tooltip-container"></span>├── reporting           // Reporting of error messages, warnings and other info.
</span><span line-number="12" class=""><span class="tooltip-container"></span>├── rewrites            // Helpers for rewriting Scala 2's constructs into dotty's.
</span><span line-number="13" class=""><span class="tooltip-container"></span>├── semanticdb          // Helpers for exporting semanticdb from trees.
</span><span line-number="14" class=""><span class="tooltip-container"></span>├── transform           // Miniphases and helpers for tree transformations.
</span><span line-number="15" class=""><span class="tooltip-container"></span>├── typer               // Type-checking and other frontend phases
</span><span line-number="16" class=""><span class="tooltip-container"></span>└── util                // General purpose utility classes and modules.
</span></code></pre> 
     <div class="buttons"></div> 
    </div> 
   </section> 
   <section id="contexts-1"> 
    <h2 class="h500"><a href="#contexts-1" class="anchor"></a>Contexts</h2> 
    <p><code>scalac</code> has almost no global state (the only significant bit of global state is the name table, which is used to hash strings into unique names). Instead, all essential bits of information that can vary over a compiler run are collected in a <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/core/Contexts.scala">Context</a>. Most methods in <code>scalac</code> take a <code>Context</code> value as an implicit parameter.</p> 
    <p>Contexts give a convenient way to customize values in some part of the call-graph. To run, e.g. some compiler function <code>f</code> at a given phase <code>phase</code>, we invoke <code>f</code> with an explicit context parameter, like this</p> 
    <div class="snippet mono-small-block" scala-snippet=""> 
     <pre><code class="language-scala"><span line-number="1" class=""><span class="tooltip-container"></span>f(/*normal args*/)(using ctx.withPhase(phase))
</span></code></pre> 
     <div class="buttons"></div> 
    </div> 
    <p>This assumes that <code>f</code> is defined in the way most compiler functions are:</p> 
    <div class="snippet mono-small-block" scala-snippet=""> 
     <pre><code class="language-scala"><span line-number="1" class=""><span class="tooltip-container"></span>def f(/*normal parameters*/)(implicit ctx: Context) ...
</span></code></pre> 
     <div class="buttons"></div> 
    </div> 
    <p>Compiler code follows the convention that all implicit <code>Context</code> parameters are named <code>ctx</code>. This is important to avoid implicit ambiguities in the case where nested methods contain each a Context parameters. The common name ensures then that the implicit parameters properly shadow each other.</p> 
    <p>Sometimes we want to make sure that implicit contexts are not captured in closures or other long-lived objects, be it because we want to enforce that nested methods each get their own implicit context, or because we want to avoid a space leak in the case where a closure can survive several compiler runs. A typical case is a completer for a symbol representing an external class, which produces the attributes of the symbol on demand, and which might never be invoked. In that case we follow the convention that any context parameter is explicit, not implicit, so we can track where it is used, and that it has a name different from <code>ctx</code>. Commonly used is <code>ictx</code> for "initialization context".</p> 
    <p>With these two conventions in place, it has turned out that implicit contexts work amazingly well as a device for dependency injection and bulk parameterization. There is of course always the danger that an unexpected implicit will be passed, but in practice this has not turned out to be much of a problem.</p> 
   </section> 
   <section id="compiler-phases-1"> 
    <h2 class="h500"><a href="#compiler-phases-1" class="anchor"></a>Compiler Phases</h2> 
    <p>Seen from a temporal perspective, the <code>scalac</code> compiler consists of a list of phases. The current list of phases is specified in class <a href="https://github.com/lampepfl/dotty/blob/main/compiler/src/dotty/tools/dotc/Compiler.scala">Compiler</a> as follows:</p> 
    <div class="snippet mono-small-block" scala-snippet=""> 
     <pre><code class="language-scala"><span line-number="1" class=""><span class="tooltip-container"></span>def phases: List[List[Phase]] =
</span><span line-number="2" class=""><span class="tooltip-container"></span>  frontendPhases ::: picklerPhases ::: transformPhases ::: backendPhases
</span><span line-number="3" class=""><span class="tooltip-container"></span>
</span><span line-number="4" class=""><span class="tooltip-container"></span>  /** Phases dealing with the frontend up to trees ready for TASTY pickling */
</span><span line-number="5" class=""><span class="tooltip-container"></span>  protected def frontendPhases: List[List[Phase]] =
</span><span line-number="6" class=""><span class="tooltip-container"></span>    List(new Parser) ::             // scanner, parser
</span><span line-number="7" class=""><span class="tooltip-container"></span>    List(new TyperPhase) ::         // namer, typer
</span><span line-number="8" class=""><span class="tooltip-container"></span>    List(new YCheckPositions) ::    // YCheck positions
</span><span line-number="9" class=""><span class="tooltip-container"></span>    List(new sbt.ExtractDependencies) :: // Sends information on classes' dependencies to sbt via callbacks
</span><span line-number="10" class=""><span class="tooltip-container"></span>    List(new semanticdb.ExtractSemanticDB) :: // Extract info into .semanticdb files
</span><span line-number="11" class=""><span class="tooltip-container"></span>    List(new PostTyper) ::          // Additional checks and cleanups after type checking
</span><span line-number="12" class=""><span class="tooltip-container"></span>    List(new sjs.PrepJSInterop) ::  // Additional checks and transformations for Scala.js (Scala.js only)
</span><span line-number="13" class=""><span class="tooltip-container"></span>    List(new sbt.ExtractAPI) ::     // Sends a representation of the API of classes to sbt via callbacks
</span><span line-number="14" class=""><span class="tooltip-container"></span>    List(new SetRootTree) ::        // Set the `rootTreeOrProvider` on class symbols
</span><span line-number="15" class=""><span class="tooltip-container"></span>    Nil
</span><span line-number="16" class=""><span class="tooltip-container"></span>
</span><span line-number="17" class=""><span class="tooltip-container"></span>  /** Phases dealing with TASTY tree pickling and unpickling */
</span><span line-number="18" class=""><span class="tooltip-container"></span>  protected def picklerPhases: List[List[Phase]] =
</span><span line-number="19" class=""><span class="tooltip-container"></span>    List(new Pickler) ::            // Generate TASTY info
</span><span line-number="20" class=""><span class="tooltip-container"></span>    List(new Inlining) ::           // Inline and execute macros
</span><span line-number="21" class=""><span class="tooltip-container"></span>    List(new PostInlining) ::       // Add mirror support for inlined code
</span><span line-number="22" class=""><span class="tooltip-container"></span>    List(new Staging) ::            // Check staging levels and heal staged types
</span><span line-number="23" class=""><span class="tooltip-container"></span>    List(new Splicing) ::           // Replace level 1 splices with holes
</span><span line-number="24" class=""><span class="tooltip-container"></span>    List(new PickleQuotes) ::       // Turn quoted trees into explicit run-time data structures
</span><span line-number="25" class=""><span class="tooltip-container"></span>    Nil
</span><span line-number="26" class=""><span class="tooltip-container"></span>
</span><span line-number="27" class=""><span class="tooltip-container"></span>  /** Phases dealing with the transformation from pickled trees to backend trees */
</span><span line-number="28" class=""><span class="tooltip-container"></span>  protected def transformPhases: List[List[Phase]] =
</span><span line-number="29" class=""><span class="tooltip-container"></span>    List(new FirstTransform,         // Some transformations to put trees into a canonical form
</span><span line-number="30" class=""><span class="tooltip-container"></span>         new CheckReentrant,         // Internal use only: Check that compiled program has no data races involving global vars
</span><span line-number="31" class=""><span class="tooltip-container"></span>         new ElimPackagePrefixes,    // Eliminate references to package prefixes in Select nodes
</span><span line-number="32" class=""><span class="tooltip-container"></span>         new CookComments,           // Cook the comments: expand variables, doc, etc.
</span><span line-number="33" class=""><span class="tooltip-container"></span>         new CheckStatic,            // Check restrictions that apply to @static members
</span><span line-number="34" class=""><span class="tooltip-container"></span>         new BetaReduce,             // Reduce closure applications
</span><span line-number="35" class=""><span class="tooltip-container"></span>         new init.Checker) ::        // Check initialization of objects
</span><span line-number="36" class=""><span class="tooltip-container"></span>    List(new ElimRepeated,           // Rewrite vararg parameters and arguments
</span><span line-number="37" class=""><span class="tooltip-container"></span>         new ExpandSAMs,             // Expand single abstract method closures to anonymous classes
</span><span line-number="38" class=""><span class="tooltip-container"></span>         new ProtectedAccessors,     // Add accessors for protected members
</span><span line-number="39" class=""><span class="tooltip-container"></span>         new ExtensionMethods,       // Expand methods of value classes with extension methods
</span><span line-number="40" class=""><span class="tooltip-container"></span>         new UncacheGivenAliases,    // Avoid caching RHS of simple parameterless given aliases
</span><span line-number="41" class=""><span class="tooltip-container"></span>         new ByNameClosures,         // Expand arguments to by-name parameters to closures
</span><span line-number="42" class=""><span class="tooltip-container"></span>         new HoistSuperArgs,         // Hoist complex arguments of supercalls to enclosing scope
</span><span line-number="43" class=""><span class="tooltip-container"></span>         new SpecializeApplyMethods, // Adds specialized methods to FunctionN
</span><span line-number="44" class=""><span class="tooltip-container"></span>         new RefChecks) ::           // Various checks mostly related to abstract members and overriding
</span><span line-number="45" class=""><span class="tooltip-container"></span>    List(new ElimOpaque,             // Turn opaque into normal aliases
</span><span line-number="46" class=""><span class="tooltip-container"></span>         new TryCatchPatterns,       // Compile cases in try/catch
</span><span line-number="47" class=""><span class="tooltip-container"></span>         new PatternMatcher,         // Compile pattern matches
</span><span line-number="48" class=""><span class="tooltip-container"></span>         new sjs.ExplicitJSClasses,  // Make all JS classes explicit (Scala.js only)
</span><span line-number="49" class=""><span class="tooltip-container"></span>         new ExplicitOuter,          // Add accessors to outer classes from nested ones.
</span><span line-number="50" class=""><span class="tooltip-container"></span>         new ExplicitSelf,           // Make references to non-trivial self types explicit as casts
</span><span line-number="51" class=""><span class="tooltip-container"></span>         new ElimByName,             // Expand by-name parameter references
</span><span line-number="52" class=""><span class="tooltip-container"></span>         new StringInterpolatorOpt) :: // Optimizes raw and s string interpolators by rewriting them to string concatentations
</span><span line-number="53" class=""><span class="tooltip-container"></span>    List(new PruneErasedDefs,        // Drop erased definitions from scopes and simplify erased expressions
</span><span line-number="54" class=""><span class="tooltip-container"></span>         new InlinePatterns,         // Remove placeholders of inlined patterns
</span><span line-number="55" class=""><span class="tooltip-container"></span>         new VCInlineMethods,        // Inlines calls to value class methods
</span><span line-number="56" class=""><span class="tooltip-container"></span>         new SeqLiterals,            // Express vararg arguments as arrays
</span><span line-number="57" class=""><span class="tooltip-container"></span>         new InterceptedMethods,     // Special handling of `==`, `|=`, `getClass` methods
</span><span line-number="58" class=""><span class="tooltip-container"></span>         new Getters,                // Replace non-private vals and vars with getter defs (fields are added later)
</span><span line-number="59" class=""><span class="tooltip-container"></span>         new SpecializeFunctions,    // Specialized Function{0,1,2} by replacing super with specialized super
</span><span line-number="60" class=""><span class="tooltip-container"></span>         new LiftTry,                // Put try expressions that might execute on non-empty stacks into their own methods
</span><span line-number="61" class=""><span class="tooltip-container"></span>         new CollectNullableFields,  // Collect fields that can be nulled out after use in lazy initialization
</span><span line-number="62" class=""><span class="tooltip-container"></span>         new ElimOuterSelect,        // Expand outer selections
</span><span line-number="63" class=""><span class="tooltip-container"></span>         new ResolveSuper,           // Implement super accessors
</span><span line-number="64" class=""><span class="tooltip-container"></span>         new FunctionXXLForwarders,  // Add forwarders for FunctionXXL apply method
</span><span line-number="65" class=""><span class="tooltip-container"></span>         new ParamForwarding,        // Add forwarders for aliases of superclass parameters
</span><span line-number="66" class=""><span class="tooltip-container"></span>         new TupleOptimizations,     // Optimize generic operations on tuples
</span><span line-number="67" class=""><span class="tooltip-container"></span>         new LetOverApply,            // Lift blocks from receivers of applications
</span><span line-number="68" class=""><span class="tooltip-container"></span>         new ArrayConstructors) ::   // Intercept creation of (non-generic) arrays and intrinsify.
</span><span line-number="69" class=""><span class="tooltip-container"></span>    List(new Erasure) ::             // Rewrite types to JVM model, erasing all type parameters, abstract types and refinements.
</span><span line-number="70" class=""><span class="tooltip-container"></span>    List(new ElimErasedValueType,    // Expand erased value types to their underlying implmementation types
</span><span line-number="71" class=""><span class="tooltip-container"></span>         new PureStats,              // Remove pure stats from blocks
</span><span line-number="72" class=""><span class="tooltip-container"></span>         new VCElideAllocations,     // Peep-hole optimization to eliminate unnecessary value class allocations
</span><span line-number="73" class=""><span class="tooltip-container"></span>         new ArrayApply,             // Optimize `scala.Array.apply([....])` and `scala.Array.apply(..., [....])` into `[...]`
</span><span line-number="74" class=""><span class="tooltip-container"></span>         new sjs.AddLocalJSFakeNews, // Adds fake new invocations to local JS classes in calls to `createLocalJSClass`
</span><span line-number="75" class=""><span class="tooltip-container"></span>         new ElimPolyFunction,       // Rewrite PolyFunction subclasses to FunctionN subclasses
</span><span line-number="76" class=""><span class="tooltip-container"></span>         new TailRec,                // Rewrite tail recursion to loops
</span><span line-number="77" class=""><span class="tooltip-container"></span>         new CompleteJavaEnums,      // Fill in constructors for Java enums
</span><span line-number="78" class=""><span class="tooltip-container"></span>         new Mixin,                  // Expand trait fields and trait initializers
</span><span line-number="79" class=""><span class="tooltip-container"></span>         new LazyVals,               // Expand lazy vals
</span><span line-number="80" class=""><span class="tooltip-container"></span>         new Memoize,                // Add private fields to getters and setters
</span><span line-number="81" class=""><span class="tooltip-container"></span>         new NonLocalReturns,        // Expand non-local returns
</span><span line-number="82" class=""><span class="tooltip-container"></span>         new CapturedVars) ::        // Represent vars captured by closures as heap objects
</span><span line-number="83" class=""><span class="tooltip-container"></span>    List(new Constructors,           // Collect initialization code in primary constructors
</span><span line-number="84" class=""><span class="tooltip-container"></span>                                        // Note: constructors changes decls in transformTemplate, no InfoTransformers should be added after it
</span><span line-number="85" class=""><span class="tooltip-container"></span>         new Instrumentation) ::     // Count calls and allocations under -Yinstrument
</span><span line-number="86" class=""><span class="tooltip-container"></span>    List(new LambdaLift,             // Lifts out nested functions to class scope, storing free variables in environments
</span><span line-number="87" class=""><span class="tooltip-container"></span>                                     // Note: in this mini-phase block scopes are incorrect. No phases that rely on scopes should be here
</span><span line-number="88" class=""><span class="tooltip-container"></span>         new ElimStaticThis,         // Replace `this` references to static objects by global identifiers
</span><span line-number="89" class=""><span class="tooltip-container"></span>         new CountOuterAccesses) ::  // Identify outer accessors that can be dropped
</span><span line-number="90" class=""><span class="tooltip-container"></span>    List(new DropOuterAccessors,     // Drop unused outer accessors
</span><span line-number="91" class=""><span class="tooltip-container"></span>         new Flatten,                // Lift all inner classes to package scope
</span><span line-number="92" class=""><span class="tooltip-container"></span>         new RenameLifted,           // Renames lifted classes to local numbering scheme
</span><span line-number="93" class=""><span class="tooltip-container"></span>         new TransformWildcards,     // Replace wildcards with default values
</span><span line-number="94" class=""><span class="tooltip-container"></span>         new MoveStatics,            // Move static methods from companion to the class itself
</span><span line-number="95" class=""><span class="tooltip-container"></span>         new ExpandPrivate,          // Widen private definitions accessed from nested classes
</span><span line-number="96" class=""><span class="tooltip-container"></span>         new RestoreScopes,          // Repair scopes rendered invalid by moving definitions in prior phases of the group
</span><span line-number="97" class=""><span class="tooltip-container"></span>         new SelectStatic,           // get rid of selects that would be compiled into GetStatic
</span><span line-number="98" class=""><span class="tooltip-container"></span>         new sjs.JUnitBootstrappers, // Generate JUnit-specific bootstrapper classes for Scala.js (not enabled by default)
</span><span line-number="99" class=""><span class="tooltip-container"></span>         new CollectSuperCalls) ::   // Find classes that are called with super
</span><span line-number="100" class=""><span class="tooltip-container"></span>    Nil
</span><span line-number="101" class=""><span class="tooltip-container"></span>
</span><span line-number="102" class=""><span class="tooltip-container"></span>  /** Generate the output of the compilation */
</span><span line-number="103" class=""><span class="tooltip-container"></span>  protected def backendPhases: List[List[Phase]] =
</span><span line-number="104" class=""><span class="tooltip-container"></span>    List(new backend.sjs.GenSJSIR) :: // Generate .sjsir files for Scala.js (not enabled by default)
</span><span line-number="105" class=""><span class="tooltip-container"></span>    List(new GenBCode) ::             // Generate JVM bytecode
</span><span line-number="106" class=""><span class="tooltip-container"></span>    Nil
</span></code></pre> 
     <div class="buttons"></div> 
    </div> 
    <p>Note that phases are grouped, so the <code>phases</code> method is of type <code>List[List[Phase]]</code>. The idea is that all phases in a group are <em>fused</em> into a single tree traversal. That way, phases can be kept small (most phases perform a single function) without requiring an excessive number of tree traversals (which are costly, because they have generally bad cache locality).</p> 
    <p>Phases fall into four categories:</p> 
    <ul> 
     <li> <p>Frontend phases: <code>Frontend</code>, <code>PostTyper</code> and <code>Pickler</code>. <code>FrontEnd</code> parses the source programs and generates untyped abstract syntax trees, which are then typechecked and transformed into typed abstract syntax trees. <code>PostTyper</code> performs checks and cleanups that require a fully typed program. In particular, it</p> 
      <ul> 
       <li>creates super accessors representing <code>super</code> calls in traits</li> 
       <li>creates implementations of synthetic (compiler-implemented) methods</li> 
       <li>avoids storing parameters passed unchanged from subclass to superclass in duplicate fields.</li> 
      </ul> <p>Finally <code>Pickler</code> serializes the typed syntax trees produced by the frontend as TASTY data structures.</p> </li> 
     <li> <p>High-level transformations: All phases from <code>FirstTransform</code> to <code>Erasure</code>. Most of these phases transform syntax trees, expanding high-level constructs to more primitive ones. The last phase in the group, <code>Erasure</code> translates all types into types supported directly by the JVM. To do this, it performs another type checking pass, but using the rules of the JVM's type system instead of Scala's.</p> </li> 
     <li> <p>Low-level transformations: All phases from <code>ElimErasedValueType</code> to <code>CollectSuperCalls</code>. These further transform trees until they are essentially a structured version of Java bytecode.</p> </li> 
     <li> <p>Code generators: These map the transformed trees to Java classfiles or .sjsir files.</p> </li> 
    </ul> 
   </section> 
  </main> 
  <div class="divider"></div> 
  <nav class="arrow-navigation" aria-label="Page navigation"> 
   <div> <span class="body-small">Previous</span> <a rel="prev" href="higher-kinded-v2.html" aria-keyshortcuts="Left" class="body-medium"> <span class="body-medium">Higher-Kinded Types in Dotty</span> </a> 
   </div> 
   <div> <span class="body-small arrow-navigation--next">Next</span> <a rel="next" href="explicit-nulls.html" aria-keyshortcuts="Right" class="body-medium"> <span class="body-medium">Explicit Nulls</span> </a> 
   </div> 
  </nav> 
  <div class="content-contributors hidden"> 
   <h1 class="h200">Contributors to this page</h1> 
   <div id="documentation-contributors" class="contributors-container"></div> 
   <div class="github-edit-button"> <a class="text-button with-link body-small" href="https://github.com/lampepfl/dotty/edit/main/docs/_docs/internals/overall-structure.md"> Edit this page on GitHub </a> 
   </div> 
  </div> 
 </div> 
</div></div><div id="toc" class="body-small"><div id="toc-container"><span class="toc-title h200">In this article</span><nav class="toc-nav"><ul class="toc-list"><li><a href="#package-structure-1">Package Structure</a></li><li><a href="#contexts-1">Contexts</a></li><li><a href="#compiler-phases-1">Compiler Phases</a></li></ul></nav></div></div></div><div id="footer" class="body-small mobile-footer"><div class="left-container">Generated with</div><div class="right-container"><a href="https://github.com/lampepfl/dotty"><button class="icon-button gh"></button></a><a href="https://twitter.com/scala_lang"><button class="icon-button twitter"></button></a><a href="https://discord.com/invite/scala"><button class="icon-button discord"></button></a><a href="https://gitter.im/scala/scala"><button class="icon-button gitter"></button></a><div class="text">Copyright (c) 2002-2023, LAMP/EPFL</div></div><div class="text-mobile">Copyright (c) 2002-2023, LAMP/EPFL</div></div></div></div></body></html>